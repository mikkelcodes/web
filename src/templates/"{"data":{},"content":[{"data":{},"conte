"{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Yes, Gatsby sites are pretty secure out of the box, so to speak, but it is still possible to leave big vulnerabilities in the source code if we are not careful with a few aspects of the Gatsby app. One thing we have to make sure we never do, is to put our API-keys on GitHub. In a public repository.","nodeType":"text"}],"nodeType":"paragraph"},{"data":{},"content":[{"data":{},"marks":[],"value":"Nothing we upload to our repos on GitHub should be possible to misuse and api-key or token copy/pasted directly into gatsby-config.js is certainly highly \"misusable\"...","nodeType":"text"}],"nodeType":"paragraph"},{"data":{},"content":[{"data":{},"marks":[],"value":"Here is how you can hide your API-keys/tokens in your Gatsby project on Netlify with Environment Variables.","nodeType":"text"}],"nodeType":"paragraph"},{"data":{},"content":[{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"First step to hiding your API-Key (or access token) is to create a ","nodeType":"text"},{"data":{},"marks":[{"type":"code"}],"value":".env.development","nodeType":"text"},{"data":{},"marks":[],"value":" file in your project's root folder.","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"list-item"},{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Inside of the .env.deveopment file, create variables for your API-keys/Tokens and set them equal to your api-keys/tokens like so:","nodeType":"text"}],"nodeType":"paragraph"},{"data":{"target":{"sys":{"id":"5qM4Nfqt4Rmbixn9buAlSS","type":"Link","linkType":"Asset"}}},"content":[],"nodeType":"embedded-asset-block"}],"nodeType":"list-item"},{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Next, we will install a tool that allows us to load environment variables from files named ","nodeType":"text"},{"data":{},"marks":[{"type":"code"}],"value":".env","nodeType":"text"},{"data":{},"marks":[],"value":". To do this, run in terminal: ","nodeType":"text"},{"data":{},"marks":[{"type":"bold"}],"value":"npm install dotenv --save","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"list-item"},{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Open gatsby-config.js and on line one, add the following code:\n","nodeType":"text"}],"nodeType":"paragraph"},{"data":{"target":{"sys":{"id":"73uSk1YL63n9vek7ajoXKH","type":"Link","linkType":"Asset"}}},"content":[],"nodeType":"embedded-asset-block"},{"data":{},"content":[{"data":{},"marks":[],"value":"\nThis code will add the variables we created in the ","nodeType":"text"},{"data":{},"marks":[{"type":"code"}],"value":".env.development","nodeType":"text"},{"data":{},"marks":[],"value":" file to the ","nodeType":"text"},{"data":{},"marks":[{"type":"code"}],"value":"process.env","nodeType":"text"},{"data":{},"marks":[],"value":" object. We can now reference our api-keys by using the ","nodeType":"text"},{"data":{},"marks":[{"type":"code"}],"value":"process.env","nodeType":"text"},{"data":{},"marks":[],"value":" object.","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"list-item"},{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Still in gatsby-config.js, locate the plugins that requires your api-keys/tokens and set appropriate key-value pairs (in accordance with plugin documentation). For the Contentful source plugin that I currently use for this site it looks like this:\n","nodeType":"text"}],"nodeType":"paragraph"},{"data":{"target":{"sys":{"id":"6y65GsXmZHEJjK5ElTi9Tc","type":"Link","linkType":"Asset"}}},"content":[],"nodeType":"embedded-asset-block"},{"data":{},"content":[{"data":{},"marks":[],"value":"At this point it's a good idea to start up our app in dev mode to confirm that our app still runs smoothly and can access the environment variables from our .env file.","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"list-item"},{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Next step is to look into the ","nodeType":"text"},{"data":{"uri":"https://git-scm.com/docs/gitignore"},"content":[{"data":{},"marks":[],"value":".gitignore","nodeType":"text"}],"nodeType":"hyperlink"},{"data":{},"marks":[],"value":" in our root directory (Git must be initialised). The file types listed in here are simply ignored from git file tracking and won't be pushed to GitHub, no matter what. Make sure .env* is listed in the .gitignore file.","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"list-item"},{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Commit and push changes.","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"list-item"},{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Log in to your ","nodeType":"text"},{"data":{"uri":"https://www.netlify.com/"},"content":[{"data":{},"marks":[],"value":"Netlify","nodeType":"text"}],"nodeType":"hyperlink"},{"data":{},"marks":[],"value":" account and go to your site's settings tab.","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"list-item"},{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Navigate to \"Build and Deploy\" - \"Environment\" in the sidebar menu.","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"list-item"},{"data":{},"content":[{"data":{},"content":[{"data":{},"marks":[],"value":"Scroll down to Environment and add your environment variables here as well.","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"list-item"}],"nodeType":"ordered-list"},{"data":{},"content":[{"data":{},"marks":[],"value":"Now, trigger a build of your site directly from Netlify and confirm that your plugins are picking up the Environment variable from Netlify!","nodeType":"text"}],"nodeType":"paragraph"},{"data":{},"content":[{"data":{},"marks":[],"value":"Thats it - hope that was helpful!","nodeType":"text"}],"nodeType":"paragraph"},{"data":{},"content":[{"data":{},"marks":[],"value":"Best regards,","nodeType":"text"}],"nodeType":"paragraph"},{"data":{},"content":[{"data":{},"marks":[],"value":"Mikkel","nodeType":"text"}],"nodeType":"paragraph"}],"nodeType":"document"}"